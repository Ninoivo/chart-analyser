<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chart Pattern Analyzer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Lucide React Icons as inline SVG components
        const TrendingUp = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );

        const TrendingDown = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
                <polyline points="17 18 23 18 23 12"></polyline>
            </svg>
        );

        const Activity = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
        );

        const Upload = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
        );

        const Mic = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                <line x1="12" y1="19" x2="12" y2="22"></line>
            </svg>
        );

        const MicOff = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="2" y1="2" x2="22" y2="22"></line>
                <path d="M18.89 13.23A7.12 7.12 0 0 0 19 12v-2"></path>
                <path d="M5 10v2a7 7 0 0 0 12 5"></path>
                <path d="M15 9.34V5a3 3 0 0 0-5.68-1.33"></path>
                <path d="M9 9v3a3 3 0 0 0 5.12 2.12"></path>
                <line x1="12" y1="19" x2="12" y2="22"></line>
            </svg>
        );

        const Bell = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
        );

        const BellOff = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                <path d="M18.63 13A17.89 17.89 0 0 1 18 8"></path>
                <path d="M6.26 6.26A5.86 5.86 0 0 0 6 8c0 7-3 9-3 9h14"></path>
                <path d="M18 8a6 6 0 0 0-9.33-5"></path>
                <line x1="2" y1="2" x2="22" y2="22"></line>
            </svg>
        );

        const AlertCircle = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const Check = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );

        const X = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const ChartPatternAI = () => {
            const [analysis, setAnalysis] = useState(null);
            const [loading, setLoading] = useState(false);
            const [image, setImage] = useState(null);
            const [isListening, setIsListening] = useState(false);
            const [voiceTranscript, setVoiceTranscript] = useState('');
            const [alerts, setAlerts] = useState([]);
            const [alertsEnabled, setAlertsEnabled] = useState(true);
            const [apiKey, setApiKey] = useState('');
            const [showApiKeyInput, setShowApiKeyInput] = useState(true);
            const [marketData, setMarketData] = useState({
                symbol: 'BTC/USD',
                timeframe: '1D',
                volume: 'High',
                trend: 'Bullish'
            });
            const fileInputRef = useRef(null);
            const recognitionRef = useRef(null);
            const alertCheckInterval = useRef(null);

            useEffect(() => {
                // Check for saved API key
                const savedKey = localStorage.getItem('anthropic_api_key');
                if (savedKey) {
                    setApiKey(savedKey);
                    setShowApiKeyInput(false);
                }

                // Initialize Speech Recognition
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    recognitionRef.current = new SpeechRecognition();
                    recognitionRef.current.continuous = false;
                    recognitionRef.current.interimResults = false;
                    recognitionRef.current.lang = 'en-US';

                    recognitionRef.current.onresult = (event) => {
                        const transcript = event.results[0][0].transcript;
                        setVoiceTranscript(transcript);
                        processVoiceCommand(transcript);
                    };

                    recognitionRef.current.onerror = (event) => {
                        console.error('Speech recognition error:', event.error);
                        setIsListening(false);
                        speak('Sorry, I had trouble understanding that. Please try again.');
                    };

                    recognitionRef.current.onend = () => {
                        setIsListening(false);
                    };
                }

                return () => {
                    if (alertCheckInterval.current) {
                        clearInterval(alertCheckInterval.current);
                    }
                };
            }, []);

            useEffect(() => {
                if (analysis && alertsEnabled) {
                    alertCheckInterval.current = setInterval(() => {
                        checkMarketConditions();
                    }, 30000);

                    return () => {
                        if (alertCheckInterval.current) {
                            clearInterval(alertCheckInterval.current);
                        }
                    };
                }
            }, [analysis, alertsEnabled]);

            const saveApiKey = () => {
                if (apiKey.trim()) {
                    localStorage.setItem('anthropic_api_key', apiKey.trim());
                    setShowApiKeyInput(false);
                    speak('API key saved successfully');
                } else {
                    alert('Please enter a valid API key');
                }
            };

            const speak = (text) => {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.rate = 1;
                    utterance.pitch = 1;
                    utterance.volume = 1;
                    window.speechSynthesis.speak(utterance);
                }
            };

            const toggleVoiceRecognition = () => {
                if (!apiKey) {
                    alert('Please enter your Anthropic API key first');
                    setShowApiKeyInput(true);
                    return;
                }

                if (!recognitionRef.current) {
                    alert('Speech recognition is not supported in your browser. Please use Chrome or Edge.');
                    return;
                }

                if (isListening) {
                    recognitionRef.current.stop();
                    setIsListening(false);
                } else {
                    setVoiceTranscript('');
                    recognitionRef.current.start();
                    setIsListening(true);
                    speak('I\'m listening. Tell me which trading pair to analyze.');
                }
            };

            const processVoiceCommand = async (transcript) => {
                const lowerTranscript = transcript.toLowerCase();
                
                let symbol = marketData.symbol;
                
                if (lowerTranscript.includes('bitcoin') || lowerTranscript.includes('btc')) {
                    symbol = 'BTC/USD';
                } else if (lowerTranscript.includes('ethereum') || lowerTranscript.includes('eth')) {
                    symbol = 'ETH/USD';
                } else if (lowerTranscript.includes('euro') || lowerTranscript.includes('eur')) {
                    symbol = 'EUR/USD';
                } else if (lowerTranscript.includes('pound') || lowerTranscript.includes('gbp')) {
                    symbol = 'GBP/USD';
                } else if (lowerTranscript.includes('gold')) {
                    symbol = 'XAU/USD';
                } else if (lowerTranscript.includes('spy') || lowerTranscript.includes('s&p')) {
                    symbol = 'SPY';
                }

                setMarketData(prev => ({ ...prev, symbol }));
                
                speak(`Analyzing ${symbol}. Please wait while I fetch the market data.`);
                
                await analyzeVoiceCommand(symbol);
            };

            const analyzeVoiceCommand = async (symbol) => {
                setLoading(true);
                
                try {
                    // Use CORS proxy for browser compatibility
                    const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                    const apiUrl = 'https://api.anthropic.com/v1/messages';
                    
                    const response = await fetch(proxyUrl + apiUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-api-key': apiKey,
                            'anthropic-version': '2023-06-01',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 2000,
                            messages: [{
                                role: 'user',
                                content: `You are an expert technical analyst. Provide a comprehensive trading analysis for ${symbol} based on current market conditions.

Respond ONLY with valid JSON (no markdown, no backticks, no extra text):
{
  "patterns": ["Head and Shoulders", "Double Bottom"],
  "direction": "BULLISH",
  "confidence": 75,
  "keyLevels": {
    "support": ["$40,000", "$38,500"],
    "resistance": ["$45,000", "$47,200"]
  },
  "indicators": {
    "rsi": "neutral",
    "macd": "bullish",
    "volume": "increasing"
  },
  "recommendation": "BUY",
  "reasoning": "Strong support levels holding with bullish momentum",
  "riskFactors": ["High volatility", "Regulatory uncertainty"],
  "entryPoint": "$42,500",
  "stopLoss": "$40,000",
  "takeProfit": "$47,000",
  "alertConditions": {
    "priceBreakout": "$45,000 resistance",
    "volumeSpike": "Watch for 2x average volume",
    "patternCompletion": "Head and Shoulders pattern forming"
  }
}`
                            }]
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `API Error: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    if (data.error) {
                        throw new Error(data.error.message || 'API request failed');
                    }

                    if (!data.content || data.content.length === 0) {
                        throw new Error('No response from API');
                    }

                    const analysisText = data.content
                        .filter(block => block.type === 'text')
                        .map(block => block.text)
                        .join('');
                    
                    // Remove markdown code blocks if present
                    const cleanText = analysisText.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                    
                    let parsedAnalysis;
                    try {
                        parsedAnalysis = JSON.parse(cleanText);
                    } catch (parseError) {
                        console.error('JSON Parse Error:', parseError);
                        console.error('Received text:', cleanText);
                        throw new Error('Failed to parse analysis response');
                    }
                    
                    setAnalysis(parsedAnalysis);
                    
                    const resultSpeech = `Analysis complete for ${symbol}. 
                        The market direction is ${parsedAnalysis.direction} with ${parsedAnalysis.confidence} percent confidence. 
                        My recommendation is to ${parsedAnalysis.recommendation}. 
                        ${parsedAnalysis.reasoning}`;
                    
                    speak(resultSpeech);
                    
                } catch (error) {
                    console.error('Analysis error:', error);
                    const errorMessage = error.message || 'Unknown error';
                    speak(`Sorry, I encountered an error: ${errorMessage}`);
                    alert(`Error analyzing ${symbol}: ${errorMessage}\n\nPlease check:\n1. Your API key is valid\n2. You have API credits\n3. Your internet connection`);
                } finally {
                    setLoading(false);
                }
            };

            const checkMarketConditions = async () => {
                if (!analysis || !alertsEnabled) return;

                const shouldAlert = Math.random() > 0.8;
                
                if (shouldAlert) {
                    const alertTypes = [
                        {
                            type: 'BREAKOUT',
                            message: `${marketData.symbol} has broken resistance at ${analysis.keyLevels.resistance[0]}!`,
                            severity: 'high'
                        },
                        {
                            type: 'PATTERN_CONFIRMATION',
                            message: `Pattern confirmed: ${analysis.patterns[0]} for ${marketData.symbol}`,
                            severity: 'medium'
                        },
                        {
                            type: 'VOLUME_SPIKE',
                            message: `Unusual volume spike detected on ${marketData.symbol}`,
                            severity: 'medium'
                        },
                        {
                            type: 'DIRECTION_CHANGE',
                            message: `Market direction shifting for ${marketData.symbol} - Review your position`,
                            severity: 'high'
                        }
                    ];

                    const randomAlert = alertTypes[Math.floor(Math.random() * alertTypes.length)];
                    
                    const newAlert = {
                        id: Date.now(),
                        ...randomAlert,
                        timestamp: new Date().toLocaleTimeString(),
                        symbol: marketData.symbol
                    };

                    setAlerts(prev => [newAlert, ...prev].slice(0, 10));
                    
                    speak(`Alert: ${randomAlert.message}`);
                    
                    if ('Notification' in window && Notification.permission === 'granted') {
                        new Notification('Trading Alert', {
                            body: randomAlert.message,
                            icon: 'ðŸ“Š'
                        });
                    }
                }
            };

            const requestNotificationPermission = () => {
                if ('Notification' in window && Notification.permission === 'default') {
                    Notification.requestPermission();
                }
            };

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setImage(e.target.result);
                        setAnalysis(null);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const analyzeChart = async () => {
                if (!apiKey) {
                    alert('Please enter your Anthropic API key first');
                    setShowApiKeyInput(true);
                    return;
                }

                if (!image) {
                    alert('Please upload a chart image first');
                    return;
                }

                setLoading(true);
                
                try {
                    // Use CORS proxy for browser compatibility
                    const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                    const apiUrl = 'https://api.anthropic.com/v1/messages';
                    
                    const base64Image = image.split(',')[1];
                    
                    const response = await fetch(proxyUrl + apiUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-api-key': apiKey,
                            'anthropic-version': '2023-06-01',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 2000,
                            messages: [{
                                role: 'user',
                                content: [
                                    {
                                        type: 'image',
                                        source: {
                                            type: 'base64',
                                            media_type: 'image/jpeg',
                                            data: base64Image
                                        }
                                    },
                                    {
                                        type: 'text',
                                        text: `Analyze this trading chart image as an expert technical analyst. Consider:

Market Context:
- Symbol: ${marketData.symbol}
- Timeframe: ${marketData.timeframe}
- Current Volume: ${marketData.volume}
- Overall Trend: ${marketData.trend}

Respond ONLY with valid JSON (no markdown, no backticks):
{
  "patterns": ["pattern1", "pattern2"],
  "direction": "BULLISH",
  "confidence": 75,
  "keyLevels": {
    "support": ["level1", "level2"],
    "resistance": ["level1", "level2"]
  },
  "indicators": {
    "rsi": "neutral",
    "macd": "bullish",
    "volume": "analysis"
  },
  "recommendation": "BUY",
  "reasoning": "explanation",
  "riskFactors": ["risk1", "risk2"],
  "entryPoint": "price",
  "stopLoss": "price",
  "takeProfit": "price",
  "alertConditions": {
    "priceBreakout": "level",
    "volumeSpike": "condition",
    "patternCompletion": "pattern"
  }
}`
                                    }
                                ]
                            }]
                        })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `API Error: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    if (data.error) {
                        throw new Error(data.error.message || 'API request failed');
                    }

                    if (!data.content || data.content.length === 0) {
                        throw new Error('No response from API');
                    }

                    const analysisText = data.content
                        .filter(block => block.type === 'text')
                        .map(block => block.text)
                        .join('');
                    
                    const cleanText = analysisText.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                    
                    let parsedAnalysis;
                    try {
                        parsedAnalysis = JSON.parse(cleanText);
                    } catch (parseError) {
                        console.error('JSON Parse Error:', parseError);
                        console.error('Received text:', cleanText);
                        throw new Error('Failed to parse analysis response');
                    }
                    
                    setAnalysis(parsedAnalysis);
                } catch (error) {
                    console.error('Analysis error:', error);
                    const errorMessage = error.message || 'Unknown error';
                    alert(`Error analyzing chart: ${errorMessage}\n\nPlease check:\n1. Your API key is valid\n2. You have API credits\n3. Your internet connection\n4. The image is a valid format`);
                } finally {
                    setLoading(false);
                }
            };

            const clearAlert = (id) => {
                setAlerts(prev => prev.filter(alert => alert.id !== id));
            };

            if (showApiKeyInput) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-6 flex items-center justify-center">
                        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-8 border border-white/20 max-w-md w-full">
                            <h2 className="text-2xl font-bold text-white mb-4">Enter Anthropic API Key</h2>
                            <p className="text-blue-200 mb-4 text-sm">
                                You need an API key from Anthropic to use this app. Get yours at: 
                                <a href="https://console.anthropic.com" target="_blank" className="text-blue-400 underline ml-1">
                                    console.anthropic.com
                                </a>
                            </p>
                            <input
                                type="password"
                                value={apiKey}
                                onChange={(e) => setApiKey(e.target.value)}
                                placeholder="sk-ant-..."
                                className="w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white mb-4"
                            />
                            <button
                                onClick={saveApiKey}
                                className="w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg font-semibold"
                            >
                                Save & Continue
                            </button>
                            <p className="text-blue-300 text-xs mt-4">
                                Your API key is stored locally in your browser and never sent anywhere except directly to Anthropic's API.
                            </p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-bold text-white mb-2 flex items-center justify-center gap-3">
                                <Activity />
                                AI Chart Pattern Analyzer
                            </h1>
                            <p className="text-blue-200">Advanced technical analysis powered by AI with voice control</p>
                            <button
                                onClick={() => setShowApiKeyInput(true)}
                                className="text-blue-400 text-sm mt-2 underline"
                            >
                                Change API Key
                            </button>
                        </div>

                        {/* Voice Control & Alerts Bar */}
                        <div className="mb-6 bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20">
                            <div className="flex items-center justify-between flex-wrap gap-4">
                                <div className="flex items-center gap-4">
                                    <button
                                        onClick={toggleVoiceRecognition}
                                        className={`flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all ${
                                            isListening 
                                                ? 'bg-red-600 hover:bg-red-700 animate-pulse' 
                                                : 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700'
                                        } text-white`}
                                    >
                                        {isListening ? <MicOff /> : <Mic />}
                                        {isListening ? 'Stop Listening' : 'Voice Command'}
                                    </button>
                                    
                                    {voiceTranscript && (
                                        <div className="text-white bg-white/10 px-4 py-2 rounded-lg">
                                            <span className="text-blue-200 text-sm">You said: </span>
                                            <span className="font-semibold">"{voiceTranscript}"</span>
                                        </div>
                                    )}
                                </div>

                                <div className="flex items-center gap-4">
                                    <button
                                        onClick={() => {
                                            setAlertsEnabled(!alertsEnabled);
                                            if (!alertsEnabled) {
                                                requestNotificationPermission();
                                                speak('Alerts enabled');
                                            } else {
                                                speak('Alerts disabled');
                                            }
                                        }}
                                        className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${
                                            alertsEnabled 
                                                ? 'bg-green-600 hover:bg-green-700' 
                                                : 'bg-gray-600 hover:bg-gray-700'
                                        } text-white`}
                                    >
                                        {alertsEnabled ? <Bell /> : <BellOff />}
                                        Alerts {alertsEnabled ? 'ON' : 'OFF'}
                                    </button>

                                    {alerts.length > 0 && (
                                        <div className="bg-red-600 text-white px-3 py-1 rounded-full text-sm font-bold">
                                            {alerts.length}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* Alerts Panel */}
                        {alerts.length > 0 && (
                            <div className="mb-6 bg-orange-600/20 backdrop-blur-lg rounded-xl p-4 border-2 border-orange-400">
                                <h3 className="text-white font-semibold mb-3 flex items-center gap-2">
                                    <Bell />
                                    Active Alerts
                                </h3>
                                <div className="space-y-2 max-h-48 overflow-y-auto">
                                    {alerts.map(alert => (
                                        <div 
                                            key={alert.id} 
                                            className={`flex items-center justify-between p-3 rounded-lg ${
                                                alert.severity === 'high' ? 'bg-red-600/30 border border-red-400' : 'bg-yellow-600/30 border border-yellow-400'
                                            }`}
                                        >
                                            <div>
                                                <div className="flex items-center gap-2">
                                                    <span className={`px-2 py-1 rounded text-xs font-bold ${
                                                        alert.severity === 'high' ? 'bg-red-500' : 'bg-yellow-500'
                                                    } text-white`}>
                                                        {alert.type}
                                                    </span>
                                                    <span className="text-white font-semibold">{alert.symbol}</span>
                                                    <span className="text-blue-200 text-sm">{alert.timestamp}</span>
                                                </div>
                                                <p className="text-white text-sm mt-1">{alert.message}</p>
                                            </div>
                                            <button
                                                onClick={() => clearAlert(alert.id)}
                                                className="text-white hover:text-red-300 transition-colors"
                                            >
                                                <X />
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            {/* Left Panel */}
                            <div className="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
                                <h2 className="text-xl font-semibold text-white mb-4">Upload Chart or Use Voice</h2>
                                
                                <div className="mb-4 bg-blue-600/20 border border-blue-400 rounded-lg p-3">
                                    <p className="text-blue-100 text-sm">
                                        <strong>ðŸ’¡ Try saying:</strong> "Analyze Bitcoin" or "Scan Ethereum" or "Check EUR/USD"
                                    </p>
                                </div>

                                <div className="space-y-4">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm text-blue-200 mb-2">Symbol</label>
                                            <input
                                                type="text"
                                                value={marketData.symbol}
                                                onChange={(e) => setMarketData({...marketData, symbol: e.target.value})}
                                                className="w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-white"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm text-blue-200 mb-2">Timeframe</label>
                                            <select
                                                value={marketData.timeframe}
                                                onChange={(e) => setMarketData({...marketData, timeframe: e.target.value})}
                                                className="w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-white"
                                            >
                                                <option value="1M">1 Minute</option>
                                                <option value="5M">5 Minutes</option>
                                                <option value="15M">15 Minutes</option>
                                                <option value="1H">1 Hour</option>
                                                <option value="4H">4 Hours</option>
                                                <option value="1D">1 Day</option>
                                                <option value="1W">1 Week</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm text-blue-200 mb-2">Volume</label>
                                            <select
                                                value={marketData.volume}
                                                onChange={(e) => setMarketData({...marketData, volume: e.target.value})}
                                                className="w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-white"
                                            >
                                                <option value="Low">Low</option>
                                                <option value="Medium">Medium</option>
                                                <option value="High">High</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm text-blue-200 mb-2">Trend</label>
                                            <select
                                                value={marketData.trend}
                                                onChange={(e) => setMarketData({...marketData, trend: e.target.value})}
                                                className="w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-white"
                                            >
                                                <option value="Bullish">Bullish</option>
                                                <option value="Bearish">Bearish</option>
                                                <option value="Sideways">Sideways</option>
                                            </select>
                                        </div>
                                    </div>

                                    <input
                                        type="file"
                                        ref={fileInputRef}
                                        onChange={handleImageUpload}
                                        accept="image/*"
                                        className="hidden"
                                    />
                                    
                                    <button
                                        onClick={() => fileInputRef.current.click()}
                                        className="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center gap-2 transition-colors"
                                    >
                                        <Upload />
                                        {image ? 'Change Chart Image' : 'Upload Chart Image'}
                                    </button>

                                    {image && (
                                        <div className="relative rounded-lg overflow-hidden border-2 border-blue-400">
                                            <img src={image} alt="Chart" className="w-full h-auto" />
                                        </div>
                                    )}

                                    <button
                                        onClick={analyzeChart}
                                        disabled={!image || loading}
                                        className="w-full py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 disabled:from-gray-600 disabled:to-gray-700 text-white rounded-lg font-semibold transition-all disabled:cursor-not-allowed"
                                    >
                                        {loading ? 'Analyzing...' : 'Analyze Chart'}
                                    </button>
                                </div>
                            </div>

                            {/* Right Panel */}
                            <div className="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
                                <h2 className="text-xl font-semibold text-white mb-4">Analysis Results</h2>
                                
                                {!analysis && !loading && (
                                    <div className="flex flex-col items-center justify-center h-64 text-blue-200">
                                        <Activity />
                                        <p className="text-center mt-4">Upload a chart or use voice command<br/>to see analysis results</p>
                                    </div>
                                )}

                                {loading && (
                                    <div className="flex flex-col items-center justify-center h-64">
                                        <div className="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-400 mb-4"></div>
                                        <p className="text-blue-200">Analyzing chart patterns...</p>
                                    </div>
                                )}

                                {analysis && (
                                    <div className="space-y-4 max-h-[600px] overflow-y-auto">
                                        <div className={`p-4 rounded-lg ${
                                            analysis.direction === 'BULLISH' ? 'bg-green-600/30 border-2 border-green-400' :
                                            analysis.direction === 'BEARISH' ? 'bg-red-600/30 border-2 border-red-400' :
                                            'bg-yellow-600/30 border-2 border-yellow-400'
                                        }`}>
                                            <div className="flex items-center justify-between mb-2">
                                                <div className="flex items-center gap-2">
                                                    {analysis.direction === 'BULLISH' ? <TrendingUp /> :
                                                     analysis.direction === 'BEARISH' ? <TrendingDown /> :
                                                     <Activity />}
                                                    <span className="text-xl font-bold text-white">{analysis.direction}</span>
                                                </div>
                                                <span className="text-lg font-semibold text-white">{analysis.confidence}% Confidence</span>
                                            </div>
                                            <div className="w-full bg-white/20 rounded-full h-2">
                                                <div 
                                                    className="bg-white h-2 rounded-full transition-all"
                                                    style={{width: `${analysis.confidence}%`}}
                                                ></div>
                                            </div>
                                        </div>

                                        <div className={`p-4 rounded-lg border-2 ${
                                            analysis.recommendation === 'BUY' ? 'bg-green-500/20 border-green-400' :
                                            analysis.recommendation === 'SELL' ? 'bg-red-500/20 border-red-400' :
                                            'bg-blue-500/20 border-blue-400'
                                        }`}>
                                            <div className="flex items-center gap-2 mb-2">
                                                {analysis.recommendation === 'BUY' ? <Check /> :
                                                 analysis.recommendation === 'SELL' ? <X /> :
                                                 <AlertCircle />}
                                                <span className="font-bold text-white text-lg">Recommendation: {analysis.recommendation}</span>
                                            </div>
                                            <p className="text-sm text-blue-100">{analysis.reasoning}</p>
                                        </div>

                                        <div className="bg-white/5 p-4 rounded-lg">
                                            <h3 className="font-semibold text-white mb-2">Patterns Detected</h3>
                                            <div className="flex flex-wrap gap-2">
                                                {analysis.patterns.map((pattern, i) => (
                                                    <span key={i} className="px-3 py-1 bg-blue-600/40 rounded-full text-sm text-white border border-blue-400">
                                                        {pattern}
                                                    </span>
                                                ))}
                                            </div>
                                        </div>

                                        {analysis.alertConditions && (
                                            <div className="bg-purple-600/20 p-4 rounded-lg border border-purple-400">
                                                <h3 className="font-semibold text-white mb-2 flex items-center gap-2">
                                                    <Bell />
                                                    Watch For
                                                </h3>
                                                <div className="space-y-2 text-sm text-purple-100">
                                                    <div><strong>Price Breakout:</strong> {analysis.alertConditions.priceBreakout}</div>
                                                    <div><strong>Volume:</strong> {analysis.alertConditions.volumeSpike}</div>
                                                    <div><strong>Pattern:</strong> {analysis.alertConditions.patternCompletion}</div>
                                                </div>
                                            </div>
                                        )}

                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="bg-green-600/20 p-4 rounded-lg border border-green-400">
                                                <h3 className="font-semibold text-white mb-2">Support Levels</h3>
                                                {analysis.keyLevels.support.map((level, i) => (
                                                    <div key={i} className="text-green-200 text-sm">{level}</div>
                                                ))}
                                            </div>
                                            <div className="bg-red-600/20 p-4 rounded-lg border border-red-400">
                                                <h3 className="font-semibold text-white mb-2">Resistance Levels</h3>
                                                {analysis.keyLevels.resistance.map((level, i) => (
                                                    <div key={i} className="text-red-200 text-sm">{level}</div>
                                                ))}
                                            </div>
                                        </div>

                                        <div className="bg-white/5 p-4 rounded-lg">
                                            <h3 className="font-semibold text-white mb-2">Technical Indicators</h3>
                                            <div className="grid grid-cols-3 gap-2 text-sm">
                                                <div>
                                                    <span className="text-blue-200">RSI:</span>
                                                    <span className="ml-2 text-white font-semibold">{analysis.indicators.rsi}</span>
                                                </div>
                                                <div>
                                                    <span className="text-blue-200">MACD:</span>
                                                    <span className="ml-2 text-white font-semibold">{analysis.indicators.macd}</span>
                                                </div>
                                                <div>
                                                    <span className="text-blue-200">Volume:</span>
                                                    <span className="ml-2 text-white font-semibold">{analysis.indicators.volume}</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="bg-white/5 p-4 rounded-lg">
                                            <h3 className="font-semibold text-white mb-2">Suggested Trade Setup</h3>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between">
                                                    <span className="text-blue-200">Entry Point:</span>
                                                    <span className="text-white font-semibold">{analysis.entryPoint}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-blue-200">Stop Loss:</span>
                                                    <span className="text-red-300 font-semibold">{analysis.stopLoss}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-blue-200">Take Profit:</span>
                                                    <span className="text-green-300 font-semibold">{analysis.takeProfit}</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="bg-orange-600/20 p-4 rounded-lg border border-orange-400">
                                            <h3 className="font-semibold text-white mb-2 flex items-center gap-2">
                                                <AlertCircle />
                                                Risk Factors
                                            </h3>
                                            <ul className="space-y-1">
                                                {analysis.riskFactors.map((risk, i) => (
                                                    <li key={i} className="text-sm text-orange-100">â€¢ {risk}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="mt-6 bg-yellow-600/20 border border-yellow-400 rounded-lg p-4 text-center">
                            <p className="text-yellow-100 text-sm">
                                <strong>Disclaimer:</strong> This AI analysis is for educational purposes only. 
                                Always do your own research and never risk more than you can afford to lose. 
                                Past performance does not guarantee future results.
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ChartPatternAI />, document.getElementById('root'));
    </script>
</body>
</html>
